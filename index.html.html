
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Buku Tamu Digital KPU</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f8f8f8; padding: 20px; }
    h1 { color: #333; }
    label { display: block; margin-top: 10px; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; }
    button { margin-top: 15px; padding: 10px 20px; background: #0055a5; color: white; border: none; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 30px; background: white; }
    th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
    th { background: #0055a5; color: white; }
  </style>
</head>
<body>
  <h1>Buku Tamu Digital - KPU</h1>
  <form id="bukuTamuForm">
    <label>Nama Lengkap:
      <input type="text" id="nama" required />
    </label>
    <label>Instansi/Asal:
      <input type="text" id="instansi" required />
    </label>
    <label>Keperluan:
      <textarea id="keperluan" required></textarea>
    </label>
    <button type="submit">Catat Tamu</button>
  </form>

  <table id="tabelTamu">
    <thead>
      <tr><th>No</th><th>Nama</th><th>Instansi</th><th>Keperluan</th><th>Waktu</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <button onclick="exportCSV()">Export ke Excel</button>

  <script>
    const form = document.getElementById('bukuTamuForm');
    const tbody = document.querySelector('#tabelTamu tbody');
    let nomor = 1;

    form.onsubmit = function(e) {
      e.preventDefault();
      const nama = document.getElementById('nama').value;
      const instansi = document.getElementById('instansi').value;
      const keperluan = document.getElementById('keperluan').value;
      const waktu = new Date().toLocaleString();

      const row = tbody.insertRow();
      row.insertCell(0).textContent = nomor++;
      row.insertCell(1).textContent = nama;
      row.insertCell(2).textContent = instansi;
      row.insertCell(3).textContent = keperluan;
      row.insertCell(4).textContent = waktu;

      form.reset();
    }

    function exportCSV() {
      let csv = "No,Nama,Instansi,Keperluan,Waktu\n";
      for (let row of tbody.rows) {
        let cols = Array.from(row.cells).map(cell => cell.textContent);
        csv += cols.join(",") + "\n";
      }

      const blob = new Blob([csv], { type: 'text/csv' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'data_buku_tamu.csv';
      link.click();
    }
  </script>
</body>
</html>
